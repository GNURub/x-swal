<link rel="import" href="../polymer/polymer.html">
<script src="../sweetalert/lib/sweet-alert.min.js"></script>
<link rel="stylesheet" href="../sweetalert/lib/sweet-alert.css">

<!--
The `open-map` element renders a Open Map Street thanks to
 [Mapbox](http://mapbox.com/).

##### Example: Sweet Alert
        <x-swal id="7" type="success" >
          <title>Something went wrong!</title>
          <text>Oops...</text>
          <img src="images/thumbs-up.jpg">
        </x-swal>

@element x-swal
@blurb Element for rendering a Open Street Map with MapBox.
@status alpha
@homepage https://ruben96.github.io/x-swal/components/x-swal/
-->


<polymer-element name="x-swal" attributes="type">
  <template>
    <style>
      :host{
        display: none;
      }
    </style>

    <content id="title" select="title, text, confirm, cancel, img"></content>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        publish:{
          /**
          * A Mapbox map object
          *
          * @property map
          * @type L.mapbox.map
          * @default null
          */
          closeOnConfirm: {
            value: false
          },
          /**
          * A Mapbox map object
          *
          * @property map
          * @type L.mapbox.map
          * @default null
          */
          allowOutsideClick: {
            value: false
          },
          /**
          * A Mapbox map object
          *
          * @property map
          * @type L.mapbox.map
          * @default null
          */
          closeOnCancel: {
            value: true
          },
          /**
          * A Mapbox map object
          *
          * @property map
          * @type L.mapbox.map
          * @default null
          */
          showCancelButton: {
            value: false
          }
        },
        attached: function(){
          this.elements = Array.prototype.slice.call(
            this.$.title.getDistributedNodes()
          );
          for(var a = 0, m; m = this.elements[a]; ++a){
            var src = m.getAttribute('src'),
                tagName = m.localName,
                textContent = m.innerHTML;
            if(tagName === 'img' && src){
              textContent = src;

            }else if(tagName === 'confirm'){
              var color = m.getAttribute('color');
              if(color){
                this.confirmButtonColor = color;
              }
            }
            this[tagName] = textContent;
          }
        },
        /**
        * Active the alert.
        *
        * @method active
        */
        active: function(cb) {
          swal({
            title: this.title || '',
            text: this.text || '',
            type: this.type || '',
            showCancelButton: this.showCancelButton,
            confirmButtonColor: this.confirmButtonColor || '#AEDEF4',
            confirmButtonText: this.confirm || 'Ok',
            cancelButtonText: this.cancel || 'Cancel',
            closeOnConfirm: this.closeOnConfirm,
            closeOnCancel: this.closeOnCancel,
            imageUrl: this.img || ''
          }, function(isConfirm){
              this.fire('confirmation', isConfirm);
              if(cb && typeof cb === "function"){
                return cb(isConfirm);
              }
              return;
              // console.log(isConfirm);
              // setTimeout(function(){
              //   this.fire('confirmation', isConfirm);
              // }.bind(this), 500);
          }.bind(this));
        }
      });

    })();
  </script>
</polymer-element>
